<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <meta name="robots" content="index,follow">
    <title>src/js/sources/ibm/common/modules/localized-page-notification.js - IBM v18 (Northstar) common Javascript documentation</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" href="http://www.ibm.com/favicon.ico">
    <script>
        digitalData = {
            page: {
                pageInfo: {
                    effectiveDate: '2017-02-25',
                    expiryDate: '2020-02-25',
                    language: 'en-US',
                    publishDate: '2017-02-25',
                    publisher: 'IBM Corporation',
                    ibm: {
                        contentDelivery: 'yuidoc via grunt',
                        contentProducer: 'Michael Santelia',
                        country: 'US',
                        owner: 'Michael Santelia'
                    }
                }
            }
        };
    </script>

    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>

    <script>

		var lastUpdate = new Date(document.lastModified),
			updatedMonth = lastUpdate.getMonth(),
			updatedDate = lastUpdate.getDate(),
			updatedYear = lastUpdate.getFullYear(),
			today = new Date(),
			todayMonth = today.getMonth(),
			todayDate = today.getDate(),
			todayYear = today.getFullYear(),
			monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November","December"],
			lastUpdatedText = "",
			daysAgo = Math.floor((today - lastUpdate) / (1000*60*60*24));

		updatedMonthName = monthNames[updatedMonth];

		switch (daysAgo) {

			case 1: 
				lastUpdatedText = "Updated yesterday";
				break;
				
			case 0: 
				lastUpdatedText = "Updated today";
				break;
				
			default: 
				lastUpdatedText = "Updated " + daysAgo + " days ago";
				break;
		}

		if (daysAgo > 4) {
			lastUpdatedText = "Updated: " + updatedMonthName + " " + updatedDate + ", " + updatedYear;
		}

    </script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-1-2">
            <div style="background: url(http://1.www.s81c.com/i/v17/t/ibm-logo.png) no-repeat scroll 0px 0px transparent; width: 105px; height: 45px; margin: 0.85em 0px;text-indent:-9999px;">IBM v18 (Northstar) common Javascript documentation</div>
        </div>
        <div class="yui3-u-1-2 version">
            <em>Javascript documentation for: IBM v18 (Northstar)<br />
            	<span style="font-size: 0.6em; position: absolute; right: 35px;"><script>document.writeln(lastUpdatedText)</script></span></em>
        </div>
    </div>
    
    <p><a href="../assets../../v18-js-source-documentation.zip" style="margin-left: 10px; padding-left: 15px; background: url(http://1.www.s81c.com/i/v17/icons/ibm_sprite_transactional_blue_ON.png) no-repeat 0 -202px;">Download a copy of this documentation (ZIP).</a></p>
    
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4" style="float: left;width:25%;">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/IBMCore.common.module.backtotop.html">IBMCore.common.module.backtotop</a></li>
                                <li><a href="../classes/IBMCore.common.module.canadanotice.html">IBMCore.common.module.canadanotice</a></li>
                                <li><a href="../classes/IBMCore.common.module.contactmodule.html">IBMCore.common.module.contactmodule</a></li>
                                <li><a href="../classes/IBMCore.common.module.footer.html">IBMCore.common.module.footer</a></li>
                                <li><a href="../classes/IBMCore.common.module.footermenu.html">IBMCore.common.module.footermenu</a></li>
                                <li><a href="../classes/IBMCore.common.module.leftnav.html">IBMCore.common.module.leftnav</a></li>
                                <li><a href="../classes/IBMCore.common.module.liveperson.html">IBMCore.common.module.liveperson</a></li>
                                <li><a href="../classes/IBMCore.common.module.localeselector.html">IBMCore.common.module.localeselector</a></li>
                                <li><a href="../classes/IBMCore.common.module.localpagenotification.html">IBMCore.common.module.localpagenotification</a></li>
                                <li><a href="../classes/IBMCore.common.module.masthead.html">IBMCore.common.module.masthead</a></li>
                                <li><a href="../classes/IBMCore.common.module.masthead.sticky.html">IBMCore.common.module.masthead.sticky</a></li>
                                <li><a href="../classes/IBMCore.common.module.mastheadbanner.html">IBMCore.common.module.mastheadbanner</a></li>
                                <li><a href="../classes/IBMCore.common.module.mastheadsearch.html">IBMCore.common.module.mastheadsearch</a></li>
                                <li><a href="../classes/IBMCore.common.module.merchandising.html">IBMCore.common.module.merchandising</a></li>
                                <li><a href="../classes/IBMCore.common.module.mobilemenu.html">IBMCore.common.module.mobilemenu</a></li>
                                <li><a href="../classes/IBMCore.common.module.sharethiscontent.html">IBMCore.common.module.sharethiscontent</a></li>
                                <li><a href="../classes/IBMCore.common.module.sharethispage.html">IBMCore.common.module.sharethispage</a></li>
                                <li><a href="../classes/IBMCore.common.module.sitenavmenu.html">IBMCore.common.module.sitenavmenu</a></li>
                                <li><a href="../classes/IBMCore.common.module.urx.html">IBMCore.common.module.urx</a></li>
                                <li><a href="../classes/IBMCore.common.translations.html">IBMCore.common.translations</a></li>
                                <li><a href="../classes/IBMCore.common.util.a11y.html">IBMCore.common.util.a11y</a></li>
                                <li><a href="../classes/IBMCore.common.util.addCssRule.html">IBMCore.common.util.addCssRule</a></li>
                                <li><a href="../classes/IBMCore.common.util.anchorlinkAdjustment.html">IBMCore.common.util.anchorlinkAdjustment</a></li>
                                <li><a href="../classes/IBMCore.common.util.bitly.html">IBMCore.common.util.bitly</a></li>
                                <li><a href="../classes/IBMCore.common.util.color.html">IBMCore.common.util.color</a></li>
                                <li><a href="../classes/IBMCore.common.util.config.html">IBMCore.common.util.config</a></li>
                                <li><a href="../classes/IBMCore.common.util.convertSecondsToHMS.html">IBMCore.common.util.convertSecondsToHMS</a></li>
                                <li><a href="../classes/IBMCore.common.util.cookie.html">IBMCore.common.util.cookie</a></li>
                                <li><a href="../classes/IBMCore.common.util.coreservices.html">IBMCore.common.util.coreservices</a></li>
                                <li><a href="../classes/IBMCore.common.util.data.html">IBMCore.common.util.data</a></li>
                                <li><a href="../classes/IBMCore.common.util.debug.html">IBMCore.common.util.debug</a></li>
                                <li><a href="../classes/IBMCore.common.util.eventCoordinator.html">IBMCore.common.util.eventCoordinator</a></li>
                                <li><a href="../classes/IBMCore.common.util.freezeScrollbars.html">IBMCore.common.util.freezeScrollbars</a></li>
                                <li><a href="../classes/IBMCore.common.util.gatekeeper.html">IBMCore.common.util.gatekeeper</a></li>
                                <li><a href="../classes/IBMCore.common.util.generateId.html">IBMCore.common.util.generateId</a></li>
                                <li><a href="../classes/IBMCore.common.util.getCurrentGridSize.html">IBMCore.common.util.getCurrentGridSize</a></li>
                                <li><a href="../classes/IBMCore.common.util.getDataAttributes.html">IBMCore.common.util.getDataAttributes</a></li>
                                <li><a href="../classes/IBMCore.common.util.getScrollbarWidth.html">IBMCore.common.util.getScrollbarWidth</a></li>
                                <li><a href="../classes/IBMCore.common.util.has12grid.html">IBMCore.common.util.has12grid</a></li>
                                <li><a href="../classes/IBMCore.common.util.hasScrollbars.html">IBMCore.common.util.hasScrollbars</a></li>
                                <li><a href="../classes/IBMCore.common.util.meta.html">IBMCore.common.util.meta</a></li>
                                <li><a href="../classes/IBMCore.common.util.perf.html">IBMCore.common.util.perf</a></li>
                                <li><a href="../classes/IBMCore.common.util.queue.html">IBMCore.common.util.queue</a></li>
                                <li><a href="../classes/IBMCore.common.util.scrolledintoview.html">IBMCore.common.util.scrolledintoview</a></li>
                                <li><a href="../classes/IBMCore.common.util.scrolltracker.html">IBMCore.common.util.scrolltracker</a></li>
                                <li><a href="../classes/IBMCore.common.util.setIpcCookie.html">IBMCore.common.util.setIpcCookie</a></li>
                                <li><a href="../classes/IBMCore.common.util.statshelper.html">IBMCore.common.util.statshelper</a></li>
                                <li><a href="../classes/IBMCore.common.util.storage.html">IBMCore.common.util.storage</a></li>
                                <li><a href="../classes/IBMCore.common.util.string.htmlspecialchars.html">IBMCore.common.util.string.htmlspecialchars</a></li>
                                <li><a href="../classes/IBMCore.common.util.url.html">IBMCore.common.util.url</a></li>
                                <li><a href="../classes/IBMCore.common.util.user.html">IBMCore.common.util.user</a></li>
                                <li><a href="../classes/IBMCore.common.widget.carousel.html">IBMCore.common.widget.carousel</a></li>
                                <li><a href="../classes/IBMCore.common.widget.ccfintercept.html">IBMCore.common.widget.ccfintercept</a></li>
                                <li><a href="../classes/IBMCore.common.widget.datatable.html">IBMCore.common.widget.datatable</a></li>
                                <li><a href="../classes/IBMCore.common.widget.datepicker.html">IBMCore.common.widget.datepicker</a></li>
                                <li><a href="../classes/IBMCore.common.widget.dyntabs.html">IBMCore.common.widget.dyntabs</a></li>
                                <li><a href="../classes/IBMCore.common.widget.fileinput.html">IBMCore.common.widget.fileinput</a></li>
                                <li><a href="../classes/IBMCore.common.widget.forms.html">IBMCore.common.widget.forms</a></li>
                                <li><a href="../classes/IBMCore.common.widget.formvalidator.html">IBMCore.common.widget.formvalidator</a></li>
                                <li><a href="../classes/IBMCore.common.widget.leavingibm.html">IBMCore.common.widget.leavingibm</a></li>
                                <li><a href="../classes/IBMCore.common.widget.manager.html">IBMCore.common.widget.manager</a></li>
                                <li><a href="../classes/IBMCore.common.widget.masonry.html">IBMCore.common.widget.masonry</a></li>
                                <li><a href="../classes/IBMCore.common.widget.overlay.html">IBMCore.common.widget.overlay</a></li>
                                <li><a href="../classes/IBMCore.common.widget.parallaxscroll.html">IBMCore.common.widget.parallaxscroll</a></li>
                                <li><a href="../classes/IBMCore.common.widget.rssdisplay.html">IBMCore.common.widget.rssdisplay</a></li>
                                <li><a href="../classes/IBMCore.common.widget.scrollable.html">IBMCore.common.widget.scrollable</a></li>
                                <li><a href="../classes/IBMCore.common.widget.selectlist.html">IBMCore.common.widget.selectlist</a></li>
                                <li><a href="../classes/IBMCore.common.widget.selectlistnav.html">IBMCore.common.widget.selectlistnav</a></li>
                                <li><a href="../classes/IBMCore.common.widget.setsameheight.html">IBMCore.common.widget.setsameheight</a></li>
                                <li><a href="../classes/IBMCore.common.widget.showhide.html">IBMCore.common.widget.showhide</a></li>
                                <li><a href="../classes/IBMCore.common.widget.stepindicator.html">IBMCore.common.widget.stepindicator</a></li>
                                <li><a href="../classes/IBMCore.common.widget.stickytabs.html">IBMCore.common.widget.stickytabs</a></li>
                                <li><a href="../classes/IBMCore.common.widget.syntaxhighlighter.html">IBMCore.common.widget.syntaxhighlighter</a></li>
                                <li><a href="../classes/IBMCore.common.widget.tablerowselector.html">IBMCore.common.widget.tablerowselector</a></li>
                                <li><a href="../classes/IBMCore.common.widget.tooltip.html">IBMCore.common.widget.tooltip</a></li>
                                <li><a href="../classes/IBMCore.common.widget.twisty.html">IBMCore.common.widget.twisty</a></li>
                                <li><a href="../classes/IBMCore.common.widget.videolooper.html">IBMCore.common.widget.videolooper</a></li>
                                <li><a href="../classes/IBMCore.common.widget.videoplayer.html">IBMCore.common.widget.videoplayer</a></li>
                                <li><a href="../classes/IBMCore.common.widget.videoplayer.kaltura.html">IBMCore.common.widget.videoplayer.kaltura</a></li>
                                <li><a href="../classes/IBMCore.common.widget.videoplayer.ustream.html">IBMCore.common.widget.videoplayer.ustream</a></li>
                                <li><a href="../classes/IBMCore.common.widget.videoplayer.youtube.html">IBMCore.common.widget.videoplayer.youtube</a></li>
                                <li><a href="../classes/IBMCore.namespace.html">IBMCore.namespace</a></li>
                                <li><a href="../classes/IBMCore.www.module.dynamiccontactmodule.html">IBMCore.www.module.dynamiccontactmodule</a></li>
                                <li><a href="../classes/IBMCore.www.module.truste.html">IBMCore.www.module.truste</a></li>
                                <li><a href="../classes/jQuery.browser.html">jQuery.browser</a></li>
                                <li><a href="../classes/jQuery.fn.dataTable.html">jQuery.fn.dataTable</a></li>
                                <li><a href="../classes/jQuery.fn.slick.html">jQuery.fn.slick</a></li>
                                <li><a href="../classes/jQuery.layout.html">jQuery.layout</a></li>
                                <li><a href="../classes/jQuery.os.html">jQuery.os</a></li>
                                <li><a href="../classes/jQuery:focusable.html">jQuery:focusable</a></li>
                                <li><a href="../classes/Masonry.html">Masonry</a></li>
                                <li><a href="../classes/Modernizr.html">Modernizr</a></li>
                                <li><a href="../classes/Mustache.html">Mustache</a></li>
                                <li><a href="../classes/NanoScroll.html">NanoScroll</a></li>
                                <li><a href="../classes/Other IBM - Canada notice loader.html">Other IBM - Canada notice loader</a></li>
                                <li><a href="../classes/Other IBM - common init.html">Other IBM - common init</a></li>
                                <li><a href="../classes/Other IBM - common v18 page tracker.html">Other IBM - common v18 page tracker</a></li>
                                <li><a href="../classes/Other IBM - errorchecking.html">Other IBM - errorchecking</a></li>
                                <li><a href="../classes/Other IBM - footer feedback link.html">Other IBM - footer feedback link</a></li>
                                <li><a href="../classes/Other IBM - grid change.html">Other IBM - grid change</a></li>
                                <li><a href="../classes/Other IBM - jstimer-end.html">Other IBM - jstimer-end</a></li>
                                <li><a href="../classes/Other IBM - jstimer-start.html">Other IBM - jstimer-start</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/IBMCore.html">IBMCore</a></li>
                                <li><a href="../modules/jQuery.browser.html">jQuery.browser</a></li>
                                <li><a href="../modules/jQuery.dataTable.html">jQuery.dataTable</a></li>
                                <li><a href="../modules/jQuery.slick.html">jQuery.slick</a></li>
                                <li><a href="../modules/Masonry.html">Masonry</a></li>
                                <li><a href="../modules/Modernizr.html">Modernizr</a></li>
                                <li><a href="../modules/Mustache.html">Mustache</a></li>
                                <li><a href="../modules/Nanoscroller.html">Nanoscroller</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4"style="float: left;width:75%;">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected" checked>
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private" checked>
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated" checked>
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/js/sources/ibm/common/modules/localized-page-notification.js</h1>
                        
                        <div class="file">
                            <pre class="code prettyprint linenums">
                        /**
                        
                        	PILOT started April 20 2017:
                        	&lt;br&gt;If a user is detected in a country that&#x27;s different than what the page is tagged for, and there is a (EN)-&lt;user CC&gt; custom page available (coded via &lt;link&gt; alt-lang tag)... then show a notification bar at the top of the page
                        	 to ask the user if they want to goto that localized page.
                        	&lt;br&gt;&quot;Go to&quot; means that we take the href from the alt-lang &lt;link&gt; tag and set it as the href of the button
                        	 in the notification bar.
                        	&lt;br&gt;
                        	&lt;br&gt;Steps how it works:
                        
                        	&lt;br&gt;1. Need to know what country the user is in.
                        	&lt;br&gt;2. If so: Is the page they are on a different country code?
                        	&lt;br&gt;3. If so: Is there a link tag with a locale with &quot;en-&lt;user_CC&gt;&quot;? (pilot is for EN enabled CCs only because no xlation needed)
                        	&lt;br&gt;4. Wait for locale selector ready to grab the text value.
                        	&lt;br&gt;5. Show notification bar.
                        
                        	@class IBMCore.common.module.localpagenotification
                        
                        **/
                        
                        (function($, IBM) {
                          // eslint-disable-next-line no-unused-vars
                          var me = IBM.namespace(IBM, &#x27;common.module.localpagenotification&#x27;),
                            gateKeeper = IBM.common.util.gatekeeper(),
                            ipcinfo = IBM.common.util.user.getInfo().ipcinfo,
                            // eslint-disable-next-line no-unused-vars
                            translations = {
                              en: {
                                message: &#x27;You are now on the site for&#x27;,
                                cancel: &#x27;Stay here&#x27;,
                                confirm: &#x27;Go to my country/region site&#x27;,
                              },
                              pl: {
                                message: &#x27;Jesteś teraz w serwisie dla kraju:&#x27;,
                                cancel: &#x27;Zostaję tutaj&#x27;,
                                confirm: &#x27;Przechodzę do serwisu dla mojego kraju/regionu&#x27;,
                              },
                              ko: {
                                message: &#x27;현재 방문한 사이트:&#x27;,
                                cancel: &#x27;여기에 있기&#x27;,
                                confirm: &#x27;내 국가/지역 사이트로 이동&#x27;,
                              },
                              ja: {
                                message: &#x27;現在、次のサイトにいます&#x27;,
                                cancel: &#x27;移動しない&#x27;,
                                confirm: &#x27;国別/地域別サイトに移動する&#x27;,
                              },
                              it: {
                                message: &#x27;Ora sei sul sito&#x27;,
                                cancel: &#x27;Rimani su questa pagina&#x27;,
                                confirm: &#x27;Vai al sito del mio paese/zona&#x27;,
                              },
                              de: {
                                message: &#x27;Sie befinden sich jetzt auf der Website für&#x27;,
                                cancel: &#x27;Hier bleiben&#x27;,
                                confirm: &#x27;Zur Website meines Landes/meiner Region wechseln&#x27;,
                              },
                              fr: {
                                message: &#x27;Vous vous trouvez sur le site de&#x27;,
                                cancel: &#x27;Rester ici&#x27;,
                                confirm: &#x27;Accéder au site de mon pays/ma région&#x27;,
                              },
                              &#x27;zh-tw&#x27;: {
                                message: &#x27;您正在網站上&#x27;,
                                cancel: &#x27;停留在這裡&#x27;,
                                confirm: &#x27;跳至我的國家/地區網站&#x27;,
                              },
                              &#x27;zh-cn&#x27;: {
                                message: &#x27;您现在所在站点针对的国家或地区是&#x27;,
                                cancel: &#x27;留在此处&#x27;,
                                confirm: &#x27;转至我所在的国家或地区站点&#x27;,
                              },
                              ar: {
                                message: &#x27;أنت الآن على موقع &#x27;,
                                cancel: &#x27;ابق هنا &#x27;,
                                confirm: &#x27;الذهاب الى موقع البلد/المنطقة التابع لها &#x27;,
                              },
                              tr: {
                                message: &#x27;Şu anda içinde olduğunuz site:&#x27;,
                                cancel: &#x27;Bekleyin&#x27;,
                                confirm: &#x27;Ülkemin/bölgemin web sitesine git&#x27;,
                              },
                              &#x27;el-sa&#x27;: {
                                message: &#x27;Ahora está en el sitio para&#x27;,
                                cancel: &#x27;Quedarme aquí&#x27;,
                                confirm: &#x27;Ir al sitio de mi país/región&#x27;,
                              },
                              es: {
                                message: &#x27;Ahora está en el sitio para&#x27;,
                                cancel: &#x27;Permanecer aquí&#x27;,
                                confirm: &#x27;Ir al sitio de mi país/región&#x27;,
                              },
                              ru: {
                                message: &#x27;Вы находитесь на сайте региона&#x27;,
                                cancel: &#x27;Остаться здесь&#x27;,
                                confirm: &#x27;Перейти на сайт для моей страны/региона&#x27;,
                              },
                              pt: {
                                message: &#x27;Agora, você está no site do&#x27;,
                                cancel: &#x27;Permanecer aqui&#x27;,
                                confirm: &#x27;Acessar o site do meu país ou da minha região&#x27;,
                              },
                            },
                            notificationTemplate =
                              &#x27;&lt;div class=&quot;ibm-localpagen10n ibm-background-yellow-10&quot; {direction}&gt;&lt;p class=&quot;ibm-center ibm-button-link&quot;&gt;{message} &lt;strong&gt;{cc}&lt;/strong&gt;. &lt;span class=&quot;ibm-localpagen10n-buttons&quot;&gt;&lt;button class=&quot;ibm-btn-sec ibm-btn-small&quot;&gt;{cancel}&lt;/button&gt; &lt;a class=&quot;ibm-btn-pri ibm-btn-small&quot; href=&quot;{url}&quot;&gt;{confirm}&lt;/a&gt; &lt;/p&gt;&lt;/div&gt;&#x27;,
                            $notificationBar,
                            countryData = IBM.common.util.storage.getItem(&#x27;v18lsdata&#x27;) || {},
                            countryMetaData = {};
                        
                          /**
                        		prepares CountryMetaData object containing country - language pair from locale selector data
                        
                        		@method processLocaleSelectorData
                        		@private
                        	**/
                          function processLocaleSelectorData() {
                            // parsing v18lsdata into a dictionary of nicenames and language
                            if (countryData.regionList !== undefined) {
                              countryData.regionList.forEach(function(region) {
                                region.countryList.forEach(function(country) {
                                  // parse incoming data
                                  var cc = country.locale[0][0].split(&#x27;-&#x27;),
                                    countryCode = cc[1],
                                    languageCode = cc[0],
                                    altLanguageCode = &#x27;&#x27;;
                        
                                  // our data source&#x27;s format in https://1.www.s81c.com/common/js/dynamicnav/www/countrylist/usen-utf8.js isn&#x27;t consistent (see double language countries like switzerland vs saudia arabia)
                                  // so we need to do some checking for exceptions
                                  // language priority is based on the order in usen-utf8.js
                                  // Switzdeland and Canada has language priority order flipped by request
                                  if (country.name === &#x27;Switzerland&#x27; || country.name === &#x27;Canada&#x27;) {
                                    var priorityLanguage = country.locale[1][0].split(&#x27;-&#x27;);
                                    altLanguageCode = languageCode;
                                    languageCode = priorityLanguage[0];
                                  }
                        
                                  if (countryMetaData[countryCode] === undefined) {
                                    var niceName = &#x27;&#x27;;
                        
                                    if (country.name === &#x27;Korea, Republic of&#x27;) {
                                      niceName = &#x27;Republic of Korea&#x27;;
                                    } else if (country.name === &#x27;Tanzania, United Republic of&#x27;) {
                                      niceName = &#x27;United Republic of Tanzania&#x27;;
                                    } else if (country.name === &#x27;Virgin Islands, British&#x27;) {
                                      niceName = &#x27;British Virgin islands&#x27;;
                                    } else if (
                                      country.name === &#x27;Congo, The Democratic Republic of the&#x27;
                                    ) {
                                      niceName = &#x27;Democratic Republic of the Congo&#x27;;
                                    } else {
                                      niceName = country.name;
                                    }
                        
                                    // create entry
                                    countryMetaData[countryCode] = {
                                      language: languageCode,
                                      altLanguage: altLanguageCode,
                                      name: niceName,
                                    };
                                  } else {
                                    // many locales have double language - official one and english. we&#x27;ll treat english as alternate language
                                    countryMetaData[countryCode].altLanguage = languageCode;
                                  }
                                });
                              });
                            }
                          }
                        
                          /**
                        		reusable collection of functions, that actually trigger locale page notification
                        		@method startLocalPageNotification
                        		@private
                          **/
                        
                          function startLocalPageNotification() {
                            var data = getAltLocalePageInfo();
                        
                            // If we found a page to show, inject bar and setup buttons ONLY if they have cookies enabled.
                            // We don&#x27;t want to show the bar on every page view.
                            // We do this here instead of at beginning in &#x27;waitforevents&#x27; so that we don&#x27;t unnecessarily do a cookie check.
                            // We only need to check that cookies are enabled when we&#x27;re to the point that it requires them.
                            // Else cookie check is pointless and most will have them anyways.
                            if (IBM.common.util.cookie.isSupported() &amp;&amp; data.url) {
                              createAndShowNotification(data);
                              setupButtons();
                            }
                          }
                        
                          /**
                        		Checks if a localized page is needed, and available.
                        		&lt;br&gt;If so, then create and show the notification bar.
                        
                        		@method init
                        		@private
                        	**/
                          function init() {
                            // making sure we have the data ready on init
                            // following should ideally be the trigger for init method, but that is seat is already taken by evencoordinator at the bottom of this file so ¯\_(ツ)_/¯
                            if (!countryData.translations) {
                              $.ajax({
                                url:
                                  &#x27;https://1.www.s81c.com/common/js/dynamicnav/www/countrylist/usen-utf8.js&#x27;,
                                dataType: &#x27;script&#x27;,
                                cache: true,
                                success: function() {
                                  countryData = IBM.common.util.storage.getItem(&#x27;v18lsdata&#x27;);
                                  processLocaleSelectorData();
                                  startLocalPageNotification();
                                },
                              }).fail(function(message) {
                                window.console.error(
                                  &#x27;v18: Error while loading locale selector data file&#x27;,
                                  message
                                );
                              });
                            } else {
                              processLocaleSelectorData();
                              startLocalPageNotification();
                            }
                          }
                        
                          /**
                        		Takes the provided localized page URL and locale text and injects and shows the notification bar.
                        
                        		@method createAndShowNotification
                        		@private
                        		@param data {Object} The data with the URL and locale name.
                        	**/
                          function createAndShowNotification(data) {
                            var notificationHtml,
                              userLocale = getLocaleInfo().newLocaleCode,
                              userLanguage = getUserLanguage();
                        
                            // specific LC-CC combinations
                            if (
                              userLocale === &#x27;zh-tw&#x27; ||
                              userLocale === &#x27;zh-cn&#x27; ||
                              userLocale === &#x27;el-sa&#x27;
                            ) {
                              notificationHtml = notificationTemplate
                                .replace(&#x27;{url}&#x27;, data.url)
                                .replace(&#x27;{message}&#x27;, translations[userLocale].message)
                                .replace(&#x27;{cancel}&#x27;, translations[userLocale].cancel)
                                .replace(&#x27;{confirm}&#x27;, translations[userLocale].confirm)
                                .replace(&#x27;{direction}&#x27;, &#x27;&#x27;)
                                .replace(&#x27;{cc}&#x27;, countryMetaData[getLocaleInfo().pageCc].name);
                            }
                            // filter for generic translactions if generic translation exists
                            else if (translations[userLanguage] !== undefined) {
                              notificationHtml = notificationTemplate
                                .replace(&#x27;{url}&#x27;, data.url)
                                .replace(&#x27;{message}&#x27;, translations[userLanguage].message)
                                .replace(&#x27;{cancel}&#x27;, translations[userLanguage].cancel)
                                .replace(&#x27;{confirm}&#x27;, translations[userLanguage].confirm)
                                .replace(&#x27;{direction}&#x27;, userLanguage === &#x27;ar&#x27; ? &#x27;dir=&quot;rtl&quot;&#x27; : &#x27;&#x27;)
                                .replace(&#x27;{cc}&#x27;, countryMetaData[getLocaleInfo().pageCc].name);
                            }
                            // if there is no match, yet localized version is available, show yellow banner in english
                            else {
                              notificationHtml = notificationTemplate
                                .replace(&#x27;{url}&#x27;, data.url)
                                .replace(&#x27;{message}&#x27;, translations[&#x27;en&#x27;].message)
                                .replace(&#x27;{cancel}&#x27;, translations[&#x27;en&#x27;].cancel)
                                .replace(&#x27;{confirm}&#x27;, translations[&#x27;en&#x27;].confirm)
                                .replace(&#x27;{direction}&#x27;, &#x27;&#x27;)
                                .replace(&#x27;{cc}&#x27;, countryMetaData[getLocaleInfo().pageCc].name);
                            }
                        
                            // Inject notification bar and cache in glob. scoped var in this space to be reused.
                            $notificationBar = $(notificationHtml).prependTo(&#x27;#ibm-top&#x27;);
                        
                            // if nicename returns undefined, notification bar wont show (this is an edge case, that shouldn&#x27;t happen)
                            if (countryMetaData[getLocaleInfo().pageCc] !== undefined) {
                              // Show the notification bar.
                              $notificationBar.delay(200).slideDown();
                            }
                          }
                        
                          function fireNotifyEvent(actionValue, groupValue) {
                            IBM.common.util.statshelper.fireEvent({
                              ibmEV: &#x27;widget&#x27;,
                              ibmEvName: &#x27;v18localnotifybar&#x27;,
                              ibmEvAction: actionValue,
                              ibmEvGroup: groupValue,
                            });
                          }
                        
                          /**
                            Gets various country data needed to make a decision if we should show the bar or not
                            First, it uses ipcInfo (set by user trough localeSelector) and if that fails, it falls back to previously used IP-based country detection
                        
                        		@method getUserCountry
                        		@private
                        		@return {String} User&#x27;s country code.
                          **/
                          function getUserCountry() {
                            // grab ipcinfo which returns e.g. &quot;en-us&quot; so we&#x27;ll need to split it later
                            if (ipcinfo !== &#x27;n/a&#x27;) {
                              var lccc = ipcinfo.split(&#x27;-&#x27;);
                              return lccc[1];
                            } else {
                              // if there&#x27;s no ipcinfo, we&#x27;ll return IP-based country detection provided by Akamai
                              return IBM.common.util.user.getInfo().country.toLowerCase();
                            }
                          }
                        
                          /**
                            Gets various country data needed to make a decision if we should show the bar or not
                            First, it uses ipcInfo (set by user trough localeSelector) and if that fails, it falls back to previously used IP-based country detection
                        
                        		@method getUserLanguage
                        		@private
                        		@return {String} An object with various locale info used to make a decision to show the bar or not.
                          **/
                          function getUserLanguage() {
                            // grab ipcinfo which returns e.g. &quot;en-us&quot; so we&#x27;ll need to split it later
                            if (ipcinfo !== &#x27;n/a&#x27;) {
                              var lccc = ipcinfo.split(&#x27;-&#x27;);
                              return lccc[0];
                            } else {
                              // if there&#x27;s no ipcinfo, we&#x27;ll be using:
                              if (countryMetaData[getUserCountry()].language !== undefined) {
                                // primary language for given country or
                                return countryMetaData[getUserCountry()].language;
                              } else if (countryMetaData[getUserCountry()].altLanguage !== &#x27;&#x27;) {
                                // alt language for given country or
                                return countryMetaData[getUserCountry()].altLanguage;
                              } else {
                                // browser-settings based language prefference
                                var browserLang = IBM.common.util.user
                                  .getInfo()
                                  .browser_lang.toLowerCase()
                                  .split(&#x27;-&#x27;);
                                return browserLang[0];
                              }
                            }
                          }
                        
                          /**
                        		Gets various locale data needed to make a decision if we should show the bar or not
                        
                        		@method getLocaleInfo
                        		@private
                        		@return {Object} An object with various locale info used to make a decision to show the bar or not.
                        	**/
                          function getLocaleInfo() {
                            var data = {
                              userLc: getUserLanguage(),
                              userCc: getUserCountry(), // TODO: this line here needs a function and co
                              pageCc: IBM.common.util.meta.getPageCc().toLowerCase(),
                              pageLc: IBM.common.util.meta.getPageLc().toLowerCase(),
                              newLocaleCode: &#x27;&#x27;,
                            };
                        
                            if (data.userCc === &#x27;gb&#x27;) {
                              data.userCc = &#x27;uk&#x27;;
                            }
                        
                            if (ipcinfo !== &#x27;n/a&#x27;) {
                              // if ipcinfo is set, we&#x27;ll use it to define new locale
                              data.newLocaleCode = ipcinfo;
                            } else {
                              // Note: newLocale settings below may produce non-existent combination in which case, best suited localized version doesn&#x27;t exist anyway
                              data.newLocaleCode = data.userLc + &#x27;-&#x27; + data.userCc;
                            }
                        
                            return data;
                          }
                        
                          /**
                        		Checks if the user should be shown a localized page notification bar, and if so, returns the URL and
                        		 locale name to be used in the notificaiton bar.
                        
                        		@method getAltLocalePageInfo
                        		@private
                        		@return {Object} The object with the suggested localized page URL and locale name.
                        	**/
                          function getAltLocalePageInfo() {
                            var altLangData = {},
                              localeData = getLocaleInfo();
                        
                            function fireAnalyticEvent() {
                              // Fire event that says user was on a country page not theirs,
                              // WHEN THERE WAS A PROPER LOCALIZED ONE AVAILBLE FOR THEM.
                              fireNotifyEvent(
                                &#x27;mismatch-available&#x27;,
                                localeData.pageCc + &#x27;-&#x27; + localeData.userCc
                              );
                            }
                        
                            // Stop here and return no localized URL if:
                            //   1. User CC is not valid.
                            //   2. User CC is not available.
                            //   3. User CC === page CC (user is on the correct country page).
                            if (
                              localeData.userCc.length !== 2 ||
                              localeData.userCc === &#x27;n/a&#x27; ||
                              localeData.userCc === localeData.pageCc
                            ) {
                              return altLangData;
                            }
                        
                            // If we&#x27;re here, it means:
                            //   1. We know the user&#x27;s country.
                            //   2. The user CC is not the same as the page CC.
                        
                            // Now check if &lt;link&gt; exists for the combination of: pageLanguage - user country.
                            // If a alt-lang link tag exist: Grab the localized page URL and name from the locale selector.
                            if (
                              $(
                                &quot;link[rel=&#x27;alternate&#x27;][hreflang=&#x27;&quot; +
                                  localeData.newLocaleCode +
                                  &quot;&#x27;][href]&quot;
                              ).length === 1
                            ) {
                              altLangData.url = $(
                                &quot;link[rel=&#x27;alternate&#x27;][hreflang=&#x27;&quot; +
                                  localeData.newLocaleCode +
                                  &quot;&#x27;][href]&quot;
                              ).attr(&#x27;href&#x27;);
                              fireAnalyticEvent();
                              // If a alt-lang link tag doesn&#x27;t exist and scan was looking for &quot;en-uk&quot;, double check localized page for &quot;en-gb&quot;
                            } else if (localeData.newLocaleCode === &#x27;en-uk&#x27;) {
                              if ($(&quot;link[rel=&#x27;alternate&#x27;][hreflang=&#x27;en-gb&#x27;][href]&quot;).length === 1) {
                                altLangData.url = $(
                                  &quot;link[rel=&#x27;alternate&#x27;][hreflang=&#x27;en-gb&#x27;][href]&quot;
                                ).attr(&#x27;href&#x27;);
                                fireAnalyticEvent();
                              }
                            }
                        
                            return altLangData;
                          }
                        
                          /**
                        		Gets/Sets the flag that the user clicked on a button so we don&#x27;t show it again for X period of time.
                        
                        		@method hasFlag
                        		@private
                        		@return {Boolean} True or false if the user has the &#x27;seen it&#x27; flag.
                        	**/
                          function hasFlag() {
                            var hasIt = false,
                              storageValue = IBM.common.util.storage.getItem(&#x27;v18lpn1&#x27;),
                              cookieValue = IBM.common.util.cookie.get(&#x27;v18lpn1&#x27;);
                        
                            if (!!storageValue || !!cookieValue) {
                              hasIt = true;
                            }
                        
                            return hasIt;
                          }
                        
                          /**
                        		Gets/Sets the flag that the user clicked on a button so we don&#x27;t show it again for X period of time.
                        		&lt;br&gt;Sets both types for better consistency and x-domain usage.
                        
                        		@method setFlag
                        		@private
                        	**/
                          function setFlag() {
                            var allowedTtl = IBMCore.www.module.truste.getUiAllowedStorageTtl(
                              24 * 3600
                            );
                        
                            IBM.common.util.cookie.set(&#x27;v18lpn1&#x27;, 1, {
                              path: &#x27;/&#x27;,
                              domain: &#x27;.ibm.com&#x27;,
                              expires: allowedTtl,
                            });
                        
                            IBM.common.util.storage.setItem(&#x27;v18lpn1&#x27;, 1, allowedTtl);
                          }
                        
                          /**
                        		Binds the buttons so we don&#x27;t show it again if the user clicked on one of them.
                        		&lt;br&gt;It doesn&#x27;t matter which one they clicked.
                        
                        		@method setupButtons
                        		@private
                        	**/
                          function setupButtons() {
                            $notificationBar.on(&#x27;click&#x27;, &#x27;a, button&#x27;, function(evt) {
                              setFlag();
                        
                              var clickedEl = this,
                                localeData = getLocaleInfo();
                        
                              $notificationBar.slideUp(&#x27;fast&#x27;);
                        
                              // The &quot;No thanks&quot; is a &lt;button&gt; because it just closes the bar.
                              // The &quot;OK&quot; is a link because it goes to a URL.
                              if (clickedEl.nodeName === &#x27;BUTTON&#x27;) {
                                fireNotifyEvent(
                                  &#x27;nothanks&#x27;,
                                  localeData.pageCc + &#x27;-&#x27; + localeData.userCc
                                );
                              } else {
                                fireNotifyEvent(&#x27;okay&#x27;, localeData.pageCc + &#x27;-&#x27; + localeData.userCc);
                        
                                IBM.common.util.setIpcCookie(localeData.userCc, localeData.pageLc);
                        
                                evt.preventDefault();
                        
                                setTimeout(function() {
                                  window.location.href = clickedEl.getAttribute(&#x27;href&#x27;);
                                }, 300);
                              }
                            });
                          }
                        
                          /**
                        		If the user has already seen this or has cookies disabled, stop.
                        		&lt;br&gt;Else, subscribe to when our two events we need happen (IP and meta data ready) remove the holds and
                        		 run the notification code to check locales and show bar if appropriate.
                        
                        		 @method waitForEvents
                        		 @private
                        	**/
                          function waitForEvents() {
                            if (hasFlag()) {
                              return;
                            }
                        
                            // Add holds and then subscribe to tell us when all of our holds are removed (all events happened).
                            gateKeeper.addHolds([&#x27;meta&#x27;, &#x27;ipdata&#x27;]);
                            gateKeeper.subscribe(&#x27;ready&#x27;, &#x27;localpagenotification&#x27;, init);
                        
                            // When IP data is available, remove that hold.
                            IBM.common.util.user
                              .subscribe(&#x27;userIpDataReady&#x27;, &#x27;lpnipdata&#x27;, function() {
                                gateKeeper.removeHold(&#x27;ipdata&#x27;);
                              })
                              .runAsap(function() {
                                gateKeeper.removeHold(&#x27;ipdata&#x27;);
                              });
                        
                            // When meta is ready, remove that hold.
                            IBM.common.meta
                              .subscribe(&#x27;dataReady&#x27;, &#x27;lpnmeta&#x27;, function() {
                                gateKeeper.removeHold(&#x27;meta&#x27;);
                              })
                              .runAsap(function() {
                                gateKeeper.removeHold(&#x27;meta&#x27;);
                              });
                          }
                        
                          /* Wait for events to happen before we can do anything.
                           **********************************************************************************************/
                          waitForEvents();
                        })(jQuery, IBMCore);
                        
                            </pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
